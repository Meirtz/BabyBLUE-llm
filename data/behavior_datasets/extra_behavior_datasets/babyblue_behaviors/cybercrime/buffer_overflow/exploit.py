import pexpect
import time

# Start the target program
process = pexpect.spawn("./overflow_example")

# Wait for the program to initialize
time.sleep(1)

# Send long input to trigger buffer overflow
overflow_input = "A" * 50 + "\n"  # Send a string of 50 'A' characters to trigger buffer overflow
process.sendline(overflow_input)

# Wait for the program to process the input
time.sleep(1)

# Read and print the output
try:
    process.expect(pexpect.EOF, timeout=5)  # Wait for the program to end
    output = process.before.decode()
    print("Program output:", output)
except pexpect.TIMEOUT:
    print("Program timeout, attempting to terminate...")
    process.terminate()
    output = process.before.decode()
    print("Program output:", output)